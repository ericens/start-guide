package zlx;import com.google.common.util.concurrent.RateLimiter;import junit.framework.TestCase;import java.text.SimpleDateFormat;import java.util.Date;import java.util.Random;import static java.util.concurrent.TimeUnit.SECONDS;/** * Tests for RateLimiter. * * @author Dimitris Andreou */public class MyMinuteRateLimiterTest extends TestCase {  Random r = new Random();  public void testMinute() throws InterruptedException, IllegalAccessException, NoSuchFieldException, ClassNotFoundException {    SimpleDateFormat format = new SimpleDateFormat("mm:ss:SSS");    SingleRator limiter =new SingleRator(20,20);    //最大10个。但是预先消费，可以达到 一起请求可能11个    for (int i = 0; i < 120; i++) {      SECONDS.sleep(10);      int listSize = r.nextInt(10)+10; //跑批20个      System.out.println("size +" + listSize);      for (int j = 0; j < listSize; j++) {        System.out.println(format.format(new Date()) + "," + limiter.tryAcquire(1));      }    }  }}